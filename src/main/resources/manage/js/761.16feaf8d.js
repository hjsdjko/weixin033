"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[761],{39761:(e,l,t)=>{t.r(l),t.d(l,{default:()=>H});t(61781),t(99939),t(38704),t(96330),t(14580),t(54371),t(802),t(45440),t(92207),t(4962),t(79029),t(17425),t(78623),t(13499),t(8461),t(63068),t(19937),t(63362);var a=t(44401),n=t(28849),u=(t(65934),t(71066)),i=t(16141),r=t(77549),o=(t(80422),t(22097),t(38865),t(59961),{class:"formModel_btn_box"});const d={__name:"formModel",emits:["formModelChange"],setup:function(e,l){var t,n=l.expose,i=l.emit,r=null===(t=(0,a.FN)())||void 0===t?void 0:t.appContext.config.globalProperties,d="storeup",c="我的收藏",s=(0,u.iH)({}),v=(0,u.iH)({refid:!1,tablename:!1,name:!1,picture:!1,type:!1,inteltype:!1,remark:!1,userid:!1}),f=(0,u.iH)(!1),p=(0,u.iH)(!1),m=(0,u.iH)(""),g=(0,u.iH)({refid:[],tablename:[],name:[{required:!0,message:"请输入",trigger:"blur"}],picture:[{required:!0,message:"请输入",trigger:"blur"}],type:[],inteltype:[],remark:[],userid:[{required:!0,message:"请输入",trigger:"blur"}]}),h=(0,u.iH)(null),w=(0,u.iH)(0),b=(0,u.iH)(""),y=function(e){s.value.picture=e},_=function(){s.value={refid:"",tablename:"",name:"",picture:"",type:"1",inteltype:"",remark:"",userid:""}},k=function(){null===r||void 0===r||r.$http({url:"".concat(d,"/info/").concat(w.value),method:"get"}).then((function(e){new RegExp("../../../file","g");s.value=e.data.data,f.value=!0}))},W=(0,u.iH)(""),C=(0,u.iH)(""),x=(0,u.iH)(""),U=(0,u.iH)(""),H=(0,u.iH)(""),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(_(),e&&(w.value=e,b.value=l),"add"==l)p.value=!0,m.value="新增"+c,f.value=!0;else if("info"==l)p.value=!1,m.value="查看"+c,k();else if("edit"==l)p.value=!0,m.value="修改"+c,k();else if("cross"==l){for(var o in p.value=!0,m.value=t,a)"refid"!=o?"tablename"!=o?"name"!=o?"picture"!=o?"type"!=o?"inteltype"!=o?"remark"!=o?"userid"!=o||(s.value.userid=a[o],v.value.userid=!0):(s.value.remark=a[o],v.value.remark=!0):(s.value.inteltype=a[o],v.value.inteltype=!0):(s.value.type=a[o],v.value.type=!0):(s.value.picture=a[o],v.value.picture=!0):(s.value.name=a[o],v.value.name=!0):(s.value.tablename=a[o],v.value.tablename=!0):(s.value.refid=a[o],v.value.refid=!0);a&&(W.value=a),n&&(C.value=n),i&&(x.value=i),u&&(U.value=u),r&&(H.value=r),s.value.type="1",f.value=!0}};n({init:$});var z=function(){f.value=!1},V=function(){null!=s.value.picture&&(s.value.picture=s.value.picture.replace(new RegExp(null===r||void 0===r?void 0:r.$config.url,"g"),""));C.value;var e=JSON.parse(JSON.stringify(W.value)),l="",t="",a="";if("cross"==b.value&&""!=U.value)if(U.value.startsWith("["))l=null===r||void 0===r?void 0:r.$toolUtil.storageGet("userid"),t=e["id"],a=U.value.replace(/\[/,"").replace(/\]/,"");else{for(var n in e)n==U.value&&(e[n]=H.value);q(e)}h.value.validate((function(e){if(e)if(l&&t){s.value.crossuserid=l,s.value.crossrefid=t;var n={page:1,limit:1e3,crossuserid:s.value.crossuserid,crossrefid:s.value.crossrefid};null===r||void 0===r||r.$http({url:"".concat(d,"/page"),method:"get",params:n}).then((function(e){if(e.data.data.total>=a)return null===r||void 0===r||r.$toolUtil.message("".concat(x.value),"error"),!1;null===r||void 0===r||r.$http({url:"".concat(d,"/").concat(s.value.id?"update":"save"),method:"post",data:s.value}).then((function(e){null===r||void 0===r||r.$toolUtil.message("操作成功","success",(function(){f.value=!1,i("formModelChange")}))}))}))}else null===r||void 0===r||r.$http({url:"".concat(d,"/").concat(s.value.id?"update":"save"),method:"post",data:s.value}).then((function(e){null===r||void 0===r||r.$toolUtil.message("操作成功","success",(function(){f.value=!1,i("formModelChange")}))}))}))},q=function(e){null===r||void 0===r||r.$http({url:"".concat(C.value,"/update"),method:"post",data:e}).then((function(e){}))};return function(e,l){var t=(0,a.up)("el-input"),n=(0,a.up)("el-form-item"),u=(0,a.up)("el-col"),i=(0,a.up)("uploads"),r=(0,a.up)("el-row"),d=(0,a.up)("el-form"),c=(0,a.up)("el-button"),w=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(w,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=function(e){return f.value=e}),title:m.value,width:"80%","destroy-on-close":"",fullscreen:!1},(0,a.Nv)({default:(0,a.w5)((function(){return[(0,a.Wm)(d,{class:"formModel_form",ref_key:"formRef",ref:h,model:s.value,"label-width":"$template2.back.add.form.base.labelWidth",rules:g.value},{default:(0,a.w5)((function(){return[(0,a.Wm)(r,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(u,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{label:"名称",prop:"name"},{default:(0,a.w5)((function(){return[(0,a.Wm)(t,{class:"list_inp",modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=function(e){return s.value.name=e}),placeholder:"名称",type:"text",readonly:!(p.value&&!v.value.name)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,a.Wm)(u,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{label:"图片",prop:"picture"},{default:(0,a.w5)((function(){return[(0,a.Wm)(i,{disabled:!(p.value&&!v.value.picture),action:"file/upload",tip:"请上传图片",limit:3,style:{width:"100%","text-align":"left"},fileUrls:s.value.picture?s.value.picture:"",onChange:y},null,8,["disabled","fileUrls"])]})),_:1})]})),_:1}),(0,a.Wm)(u,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{label:"推荐类型",prop:"inteltype"},{default:(0,a.w5)((function(){return[(0,a.Wm)(t,{class:"list_inp",modelValue:s.value.inteltype,"onUpdate:modelValue":l[1]||(l[1]=function(e){return s.value.inteltype=e}),placeholder:"推荐类型",type:"text",readonly:!(p.value&&!v.value.inteltype)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,a.Wm)(u,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{label:"备注",prop:"remark"},{default:(0,a.w5)((function(){return[(0,a.Wm)(t,{class:"list_inp",modelValue:s.value.remark,"onUpdate:modelValue":l[2]||(l[2]=function(e){return s.value.remark=e}),placeholder:"备注",type:"text",readonly:!(p.value&&!v.value.remark)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[p.value||"logistics"==b.value||"reply"==b.value?{name:"footer",fn:(0,a.w5)((function(){return[(0,a._)("span",o,[(0,a.Wm)(c,{class:"formModel_cancel",onClick:z},{default:(0,a.w5)((function(){return[(0,a.Uk)("取消")]})),_:1}),(0,a.Wm)(c,{class:"formModel_confirm",type:"primary",onClick:V},{default:(0,a.w5)((function(){return[(0,a.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var c=t(51059);const s=(0,c.Z)(d,[["__scopeId","data-v-18e9070e"]]),v=s;var f=function(e){return(0,a.dD)("data-v-5d4de7b6"),e=e(),(0,a.Cn)(),e},p={class:"app-contain"},m={class:"list_search_view"},g={class:"search_view"},h=f((function(){return(0,a._)("div",{class:"search_label"}," 名称： ",-1)})),w={class:"search_box"},b={class:"search_btn_view"},y=f((function(){return(0,a._)("br",null,null,-1)})),_={class:"btn_view"},k=f((function(){return(0,a._)("br",null,null,-1)})),W={key:0},C={key:1};const x={__name:"list",setup:function(e){var l,t=null===(l=(0,a.FN)())||void 0===l?void 0:l.appContext.config.globalProperties,o="storeup",d="我的收藏",c=(0,i.yj)();(0,a.YP)((function(){return c.query.type}),(function(){I()})),(0,a.bv)((function(){}));var s=(0,u.iH)(null),f=(0,u.iH)(null),x=(0,u.iH)({page:1,limit:20,sort:"id",order:"desc"}),U=(0,u.iH)({}),H=(0,u.iH)([]),$=(0,u.iH)(!1),z=function(e){(0,a.Y3)((function(){f.value.clearSelection(),f.value.toggleRowSelection(e)}))},V=function(){$.value=!0;var e=JSON.parse(JSON.stringify(x.value));e["type"]=c.query.type,e["sort"]="id",e["order"]="desc",U.value.name&&""!=U.value.name&&(e["name"]="%"+U.value.name+"%"),null===t||void 0===t||t.$http({url:"".concat(o,"/page"),method:"get",params:e}).then((function(e){$.value=!1,s.value=e.data.data.list,M.value=Number(e.data.data.total)}))},q=function(e){var l=(0,u.iH)([]);if(e)l.value=[e];else{if(!H.value.length)return!1;for(var a in H.value)l.value.push(H.value[a].id)}r.T.confirm("是否删除选中".concat(d),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){null===t||void 0===t||t.$http({url:"".concat(o,"/delete"),method:"post",data:l.value}).then((function(e){null===t||void 0===t||t.$toolUtil.message("删除成功","success",(function(){V()}))}))}))},j=function(e){H.value=e},M=(0,u.iH)(0),N=(0,u.iH)(["total","prev","pager","next","sizes"]),S=function(e){x.value.limit=e,V()},R=function(e){x.value.page=e,V()},D=function(){x.value.page=x.value.page-1,V()},J=function(){x.value.page=x.value.page+1,V()},O=function(e,l){return null===t||void 0===t?void 0:t.$toolUtil.isAuth(e,l)},P=function(){x.value.page=1,V()},F=(0,u.iH)(null),T=function(){P()},A=function(){F.value.init()},B=function(){H.value.length&&F.value.init(H.value[0].id,"edit")},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?F.value.init(e,"info"):H.value.length&&F.value.init(H.value[0].id,"info")},I=function(){V()};return I(),function(e,l){var t=(0,a.up)("el-input"),u=(0,a.up)("el-button"),i=(0,a.up)("el-form"),r=(0,a.up)("el-table-column"),o=(0,a.up)("el-image"),d=(0,a.up)("el-table"),c=(0,a.up)("el-pagination"),V=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",p,[(0,a._)("div",m,[(0,a.Wm)(i,{model:U.value,class:"search_form"},{default:(0,a.w5)((function(){return[(0,a._)("div",g,[h,(0,a._)("div",w,[(0,a.Wm)(t,{class:"search_inp",modelValue:U.value.name,"onUpdate:modelValue":l[0]||(l[0]=function(e){return U.value.name=e}),placeholder:"名称",clearable:""},null,8,["modelValue"])])]),(0,a._)("div",b,[(0,a.Wm)(u,{class:"search_btn",type:"primary",onClick:l[1]||(l[1]=function(e){return P()}),size:"small"},{default:(0,a.w5)((function(){return[(0,a.Uk)("搜索")]})),_:1})])]})),_:1},8,["model"]),y,(0,a._)("div",_,[O("storeup","新增")?((0,a.wg)(),(0,a.j4)(u,{key:0,type:"success",onClick:A},{default:(0,a.w5)((function(){return[(0,a.Uk)("新增")]})),_:1})):(0,a.kq)("",!0),O("storeup","查看")?((0,a.wg)(),(0,a.j4)(u,{key:1,type:"info",disabled:1!=H.value.length,onClick:l[2]||(l[2]=function(e){return E(null)})},{default:(0,a.w5)((function(){return[(0,a.Uk)("详情")]})),_:1},8,["disabled"])):(0,a.kq)("",!0),O("storeup","修改")?((0,a.wg)(),(0,a.j4)(u,{key:2,type:"primary",disabled:1!=H.value.length,onClick:B},{default:(0,a.w5)((function(){return[(0,a.Uk)("修改")]})),_:1},8,["disabled"])):(0,a.kq)("",!0),O("storeup","删除")?((0,a.wg)(),(0,a.j4)(u,{key:3,type:"danger",disabled:!H.value.length,onClick:l[3]||(l[3]=function(e){return q(null)})},{default:(0,a.w5)((function(){return[(0,a.Uk)("删除")]})),_:1},8,["disabled"])):(0,a.kq)("",!0)])]),k,O("storeup","查看")?(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{key:0,border:"",stripe:!1,onSelectionChange:j,ref_key:"table",ref:f,data:s.value,onRowClick:z},{default:(0,a.w5)((function(){return[(0,a.Wm)(r,{resizable:!0,align:"left","header-align":"left",type:"selection",width:"55"}),(0,a.Wm)(r,{label:"序号",width:"70",resizable:!0,sortable:!1,align:"left","header-align":"left"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,n.zw)(e.$index+1),1)]})),_:1}),(0,a.Wm)(r,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"名称"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,n.zw)(e.row.name),1)]})),_:1}),(0,a.Wm)(r,{label:"图片",width:"120",resizable:!0,sortable:!1,align:"left","header-align":"left"},{default:(0,a.w5)((function(l){return[l.row.picture?((0,a.wg)(),(0,a.iD)("div",W,["http"==l.row.picture.substring(0,4)?((0,a.wg)(),(0,a.j4)(o,{key:0,"preview-teleported":"","preview-src-list":[l.row.picture.split(",")[0]],src:l.row.picture.split(",")[0],style:{width:"100px",height:"100px"}},null,8,["preview-src-list","src"])):((0,a.wg)(),(0,a.j4)(o,{key:1,"preview-teleported":"","preview-src-list":[e.$config.url+l.row.picture.split(",")[0]],src:e.$config.url+l.row.picture.split(",")[0],style:{width:"100px",height:"100px"}},null,8,["preview-src-list","src"]))])):((0,a.wg)(),(0,a.iD)("div",C,"无图片"))]})),_:1}),(0,a.Wm)(r,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"推荐类型"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,n.zw)(e.row.inteltype),1)]})),_:1}),(0,a.Wm)(r,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"备注"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,n.zw)(e.row.remark),1)]})),_:1}),(0,a.Wm)(r,{label:"操作",width:"300",resizable:!0,sortable:!1,align:"left","header-align":"left"},{default:(0,a.w5)((function(e){return[O("storeup","查看")?((0,a.wg)(),(0,a.j4)(u,{key:0,type:"info",onClick:function(l){return E(e.row.id)}},{default:(0,a.w5)((function(){return[(0,a.Uk)("详情")]})),_:2},1032,["onClick"])):(0,a.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[V,$.value]]):(0,a.kq)("",!0),(0,a.Wm)(c,{background:"",layout:N.value.join(","),total:M.value,"page-size":x.value.limit,"prev-text":"上一页","next-text":"下一页","hide-on-single-page":!0,style:{padding:"0",margin:"20px 0 0",whiteSpace:"nowrap",color:"#333",textAlign:"center",width:"100%",fontWeight:"500"},onSizeChange:S,onCurrentChange:R,onPrevClick:D,onNextClick:J},null,8,["layout","total","page-size"])]),(0,a.Wm)(v,{ref_key:"formRef",ref:F,onFormModelChange:T},null,512)])}}},U=(0,c.Z)(x,[["__scopeId","data-v-5d4de7b6"]]),H=U}}]);
//# sourceMappingURL=761.16feaf8d.js.map